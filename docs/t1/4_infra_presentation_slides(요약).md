# CALI ì¸í”„ë¼ êµ¬ì¶• - PPT ë°œí‘œ ìë£Œ

> **ë°œí‘œì**: Infrastructure Lead  
> **ëŒ€ìƒ**: ë™ë£Œ ì—”ì§€ë‹ˆì–´  
> **ì´ ë°œí‘œ ì‹œê°„**: 15ë¶„ (ìŠ¬ë¼ì´ë“œë‹¹ 2-3ë¶„)

---

## ğŸ¯ Slide 1: ë„ì „ ê³¼ì œ

### ì œëª©
**"5ì¼ì˜ ë„ì „: Production-Ready ì¸í”„ë¼ êµ¬ì¶•"**

### ìŠ¬ë¼ì´ë“œ ë‚´ìš©

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

            CALI Infrastructure
   5ì¼ ë§Œì— ì™„ì„±í•œ Production-Ready EKS í”Œë«í¼

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“‹ í”„ë¡œì íŠ¸ ëª©í‘œ
   AWS EKS ê¸°ë°˜ ì‹¤ì‹œê°„ ë¡œê·¸ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

â±ï¸ ìš°ë¦¬ê°€ ë§ˆì£¼í•œ ì œì•½
   â€¢ ê°œë°œ ê¸°ê°„: ë‹¨ 5ì¼
   â€¢ êµ¬ì¶• ë²”ìœ„: 11ê°œ AWS ë¦¬ì†ŒìŠ¤ + 7ê°œ Kubernetes ì„œë¹„ìŠ¤
   â€¢ ë³´ì•ˆ ìš”êµ¬: IAM Least Privilege 100%
   â€¢ ë¹„ìš© ì œí•œ: $50/day ì´í•˜

âœ… ë‹¬ì„± ë°©ì‹
   terraform apply í•œ ë²ˆìœ¼ë¡œ ì „ì²´ ì¸í”„ë¼ ìë™ ë°°í¬
```

### ë°œí‘œì ë…¸íŠ¸ (2ë¶„)

- **Opening**: "5ì¼ ì•ˆì— Production ì¸í”„ë¼ë¥¼ êµ¬ì¶•í•˜ë¼ëŠ” ë¯¸ì…˜ì„ ë°›ì•˜ìŠµë‹ˆë‹¤"
- **ì œì•½ ê°•ì¡°**: ì‹œê°„, ë²”ìœ„, ë³´ì•ˆ, ë¹„ìš© - 4ê°€ì§€ ëª¨ë‘ íƒ€í˜‘ ë¶ˆê°€
- **í•´ê²°ì±… ì œì‹œ**: IaC(Infrastructure as Code) ì „ëµ ì„ íƒ
- **ì²­ì¤‘ ì§ˆë¬¸ ìœ ë„**: "ì—¬ëŸ¬ë¶„ì´ë¼ë©´ ì–´ë–»ê²Œ ì ‘ê·¼í•˜ì…¨ì„ê¹Œìš”?"

---

## ğŸ—ï¸ Slide 2: ì „ì²´ ì•„í‚¤í…ì²˜

### ì œëª©
**"ë‹¨ì¼ `terraform apply`ë¡œ ìƒì„±ë˜ëŠ” ëª¨ë“  ê²ƒ"**

### ìŠ¬ë¼ì´ë“œ ë‚´ìš©

```mermaid
graph TB
    subgraph "Terraform ë°°í¬ ìˆœì„œ"
        A[providers.tf<br/>AWS/Helm/K8s Provider ì„¤ì •]
        B[06-iam.tf<br/>IAM Role 7ê°œ ìƒì„±]
        C[Data Layer<br/>Kinesis, S3, OpenSearch]
        D[05-eks.tf<br/>EKS Cluster + Node Group]
        E[10-helm-releases.tf<br/>Airflow, Milvus, Grafana, Fluent Bit]
        F[11-k8s-apps.tf<br/>Consumer, Log Generator]
    end
    
    A --> B
    B --> C
    B --> D
    D --> E
    D --> F
    
    style A fill:#e0e0e0,stroke:#333,stroke-width:2px,color:#000
    style B fill:#ff6b6b,stroke:#333,stroke-width:2px,color:#fff
    style C fill:#ffd93d,stroke:#333,stroke-width:2px,color:#000
    style D fill:#4ecdc4,stroke:#333,stroke-width:2px,color:#000
    style E fill:#95e1d3,stroke:#333,stroke-width:2px,color:#000
    style F fill:#a8e6cf,stroke:#333,stroke-width:2px,color:#000
```

**Infrastructure as Code ë°°í¬ ìˆœì„œ**

| ë‹¨ê³„ | Terraform íŒŒì¼ | ìƒì„± ë¦¬ì†ŒìŠ¤ | ë°°í¬ ë°©ì‹ |
|------|---------------|------------|----------|
| **1ë‹¨ê³„** | `providers.tf` | AWS, Helm, Kubernetes Provider | ì´ˆê¸° ì„¤ì • |
| **2ë‹¨ê³„** | `06-iam.tf` | 7ê°œ IAM Role (EKS, Airflow, App ë“±) | ìš°ì„  ìƒì„± (ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ê°€ ì°¸ì¡°) |
| **3ë‹¨ê³„** | `01-kinesis.tf`, `02-s3.tf`, `03-opensearch.tf` | Kinesis Stream, S3 Bucket, OpenSearch | ë³‘ë ¬ ìƒì„± |
| **4ë‹¨ê³„** | `05-eks.tf` | EKS Cluster, Node Group (t3.medium Ã— 2~4) | ìˆœì°¨ ìƒì„± (12ë¶„ ì†Œìš”) |
| **5ë‹¨ê³„** | `07-ecr.tf` | Container Registry (Airflow, Consumer, Log Generator) | ì´ë¯¸ì§€ ë¹Œë“œ/í‘¸ì‹œ |
| **6ë‹¨ê³„** | `10-helm-releases.tf` | Airflow, Milvus, Grafana, Fluent Bit | Helm Providerë¡œ ìë™ ë°°í¬ |
| **7ë‹¨ê³„** | `11-k8s-apps.tf` | Consumer, Log Generator Deployment | Kubernetes Provider |
| **8ë‹¨ê³„** | `08-autoscaler.tf`, `09-metrics-server.tf` | Cluster Autoscaler, Metrics Server | Auto-scaling ì¸í”„ë¼ |

**í•µì‹¬ ìˆ˜ì¹˜**
- **Terraform íŒŒì¼**: 13ê°œ
- **ë°°í¬ ì‹œê°„**: **25ë¶„** (OpenSearch 18ë¶„ + EKS 12ë¶„ì´ ëŒ€ë¶€ë¶„)
- **ìˆ˜ë™ í´ë¦­**: **0íšŒ** (ì™„ì „ ìë™í™”)
- **ì¬í˜„ ê°€ëŠ¥ì„±**: **100%** (ì½”ë“œ = ë¬¸ì„œ)

### ë°œí‘œì ë…¸íŠ¸ (3ë¶„)

- **ë°°í¬ ìˆœì„œ ê°•ì¡°**: "IAMì„ ë¨¼ì € ë§Œë“¤ì–´ì•¼ EKS, Airflow ë“±ì´ í•´ë‹¹ Roleì„ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
- **Terraform + Helm í†µí•©**: "Kubernetes ì• í”Œë¦¬ì¼€ì´ì…˜(Airflow, Milvus)ê¹Œì§€ Terraform `helm_release` ë¦¬ì†ŒìŠ¤ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤"
- **ë°°í¬ ì‹œê°„ ì„¤ëª…**: "25ë¶„ ì¤‘ ëŒ€ë¶€ë¶„ì€ AWS í”„ë¡œë¹„ì €ë‹ ì‹œê°„ì…ë‹ˆë‹¤. OpenSearchê°€ 18ë¶„ìœ¼ë¡œ ê°€ì¥ ì˜¤ë˜ ê±¸ë¦½ë‹ˆë‹¤"
- **í•µì‹¬ í¬ì¸íŠ¸**: "ì½”ë“œë§Œ ìˆìœ¼ë©´ ëˆ„êµ¬ë‚˜ ë™ì¼í•œ ì¸í”„ë¼ë¥¼ ì¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìˆ˜ë™ ì„¤ì • 0ê±´"
- **ì‹¤ì œ ì˜ˆì‹œ**: "íŒ€ì›ì´ ìƒˆë¡œ í•©ë¥˜í•´ë„ `terraform apply` í•œ ë²ˆì´ë©´ ë"


---

## ğŸ” Slide 2.5: IAM ê¶Œí•œ ì„¤ê³„ (ë³´ì•ˆ)

### ì œëª©
**"IRSAì™€ Least Privilege: ë³´ì•ˆ ì‚¬ê³ ë¥¼ ì‚¬ì „ì— ì°¨ë‹¨"**

### ìŠ¬ë¼ì´ë“œ ë‚´ìš©

**ì™œ IRSAì™€ Least Privilegeì¸ê°€?**

| ê¸°ìˆ  | í•´ê²°í•˜ëŠ” ë¬¸ì œ | ì‚¬ìš© ì•ˆ í•˜ë©´? (ìœ„í—˜) |
|------|--------------|---------------------|
| **IRSA** | Podë§ˆë‹¤ ë‹¤ë¥¸ AWS ê¶Œí•œ í•„ìš”<br/>(ConsumerëŠ” Kinesis ì½ê¸°<br/>AirflowëŠ” S3 ì“°ê¸°) | âŒ AWS Access Key í•˜ë“œì½”ë”©<br/>âŒ Git ë…¸ì¶œ ìœ„í—˜<br/>âŒ ëª¨ë“  Pod ë™ì¼ ê¶Œí•œ ì‚¬ìš© |
| **Least Privilege** | í•´í‚¹/ì‹¤ìˆ˜ ì‹œ í”¼í•´ ìµœì†Œí™”<br/>(FirehoseëŠ” S3 ì“°ê¸°ë§Œ) | âŒ ê´€ë¦¬ì ê¶Œí•œ ë‚¨ë°œ<br/>âŒ ì‹¤ìˆ˜ë¡œ ì „ì²´ S3 ì‚­ì œ ê°€ëŠ¥<br/>âŒ í•´í‚¹ ì‹œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ |

**IAM Role êµ¬ì„± (Least Privilege ì ìš©)**

| Pod / Service | ServiceAccount | IAM Role | ê¶Œí•œ ë²”ìœ„ |
|---------------|----------------|----------|----------|
| **Consumer** | `consumer-sa` | `cali-app-role` | Kinesis ì½ê¸°, S3 ì“°ê¸° <br/>(ë¦¬ì†ŒìŠ¤: `cali-*`ë§Œ) |
| **Airflow** | `airflow-*` (5ê°œ) | `cali-airflow-role` | S3 ì½ê¸°/ì“°ê¸° <br/>(ë²„í‚·: `cali-logs-*`ë§Œ) |
| **Grafana** | `grafana` | `cali-grafana-role` | OpenSearch ì½ê¸° ì „ìš© |
| **Cluster Autoscaler** | `cluster-autoscaler` | `cali-autoscaler-role` | Auto Scaling ì œì–´ <br/>(íƒœê·¸: `cali-*`ë§Œ) |
| **Firehose** | (AWS Service) | `cali-firehose-role` | S3 `PutObject`ë§Œ <br/>(ì½ê¸°/ì‚­ì œ ë¶ˆê°€) |

**í•µì‹¬ ìˆ˜ì¹˜**
- **IAM Role ê°œìˆ˜**: 7ê°œ (ì—­í• ë³„ ì™„ì „ ë¶„ë¦¬)
- **í•˜ë“œì½”ë”©ëœ AWS Credentials**: **0ê°œ** (IRSA 100% ì ìš©)
- **ê´€ë¦¬ì ê¶Œí•œ ì‚¬ìš©**: **0ê±´** (Least Privilege 100%)
- **ë¦¬ì†ŒìŠ¤ ì œí•œ**: ëª¨ë“  ì •ì±…ì— `cali-*` ARN ëª…ì‹œ

### ë°œí‘œì ë…¸íŠ¸ (3ë¶„)

- **IRSA ê°•ì¡°**: "Podì— AWS Keyë¥¼ í™˜ê²½ ë³€ìˆ˜ë¡œ ë„£ì§€ ì•ŠìŠµë‹ˆë‹¤. OIDCë¥¼ í†µí•´ ì„ì‹œ ìê²© ì¦ëª…ì„ ìë™ ë°œê¸‰ë°›ìŠµë‹ˆë‹¤"
- **ì‹¤ì œ ì˜ˆì‹œ**: "ë§Œì•½ Consumer Podì´ í•´í‚¹ë‹¹í•´ë„, Kinesisì™€ S3ë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê³  EC2ë‚˜ RDSëŠ” ê±´ë“œë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
- **Least Privilege ì‚¬ë¡€**: 
  - "FirehoseëŠ” S3ì— ì“°ê¸°ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì‹¤ìˆ˜ë¡œ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
  - "ëª¨ë“  ê¶Œí•œì— ë¦¬ì†ŒìŠ¤ ARNì´ `cali-*`ë¡œ ì œí•œë˜ì–´ ìˆì–´, ë‹¤ë¥¸ í”„ë¡œì íŠ¸ ë¦¬ì†ŒìŠ¤ëŠ” ì ‘ê·¼ ë¶ˆê°€"
- **ë¹„êµ ê°•ì¡°**: "ë§Œì•½ AdministratorAccessë¥¼ ì“´ë‹¤ë©´? í•´ì»¤ê°€ ì „ì²´ AWS ê³„ì •ì„ ì¥ì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
- **êµí›ˆ**: "ë³´ì•ˆì€ ë‚˜ì¤‘ì— ì¶”ê°€í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼, ì²˜ìŒë¶€í„° ì„¤ê³„ì— í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤"

---

## â˜¸ï¸ Slide 2.6: EKS Cluster ë°°í¬

### ì œëª©
**"EKS ì¸í”„ë¼ ìë™ ë°°í¬: 06-iam.tf â†’ 05-eks.tf ìˆœì°¨ ìƒì„±"**

### ìŠ¬ë¼ì´ë“œ ë‚´ìš©

**EKS Terraform ë°°í¬ ìˆœì„œ (`05-eks.tf`)**

| ë‹¨ê³„ | ë¦¬ì†ŒìŠ¤ | ìƒì„± ë‚´ìš© | ë°°í¬ ë°©ì‹ |
|------|--------|----------|----------|
| **1ë‹¨ê³„** | VPC/Subnet (Data Source) | ê¸°ë³¸ VPC ë° ì„œë¸Œë„· ì¡°íšŒ | ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ ì°¸ì¡° |
| **2ë‹¨ê³„** | `aws_eks_cluster.main` | EKS Cluster 1.29<br/>- API/Audit/Authenticator ë¡œê¹…<br/>- Public + Private ì—”ë“œí¬ì¸íŠ¸ | **~8ë¶„ ì†Œìš”**<br/>IAM Role ì˜ì¡´ |
| **3ë‹¨ê³„** | `aws_eks_node_group.main` | Node Group (t3.medium)<br/>- Min/Desired/Max: 2/2/4<br/>- On-Demand ì¸ìŠ¤í„´ìŠ¤ | **~4ë¶„ ì†Œìš”**<br/>Cluster ìƒì„± í›„ |
| **4ë‹¨ê³„** | `aws_eks_access_entry` | íŒ€ì› EKS ë“±ë¡<br/>- IAM ARN â†’ EKS ì—°ê²° | for_eachë¡œ ë³‘ë ¬ ìƒì„± |
| **5ë‹¨ê³„** | `aws_eks_access_policy_association` | íŒ€ì›ë³„ Admin ê¶Œí•œ ë¶€ì—¬<br/>- AmazonEKSClusterAdminPolicy ì—°ê²° | Access Entry ìƒì„± í›„ |
| **6ë‹¨ê³„** | `aws_iam_openid_connect_provider` | OIDC Provider ìƒì„±<br/>- **IRSA ê¸°ë°˜ êµ¬ì¶•**<br/>- EKS â†” IAM ì‹ ë¢° ê´€ê³„ ì„¤ì • | **ëª¨ë“  IRSAì˜ ì „ì œì¡°ê±´**<br/>06-iam.tf 7ê°œ Roleì´ ì°¸ì¡° |
| **7ë‹¨ê³„** | `aws_eks_addon.ebs_csi` | EBS CSI Driver Addon<br/>- PVC/StorageClass ì§€ì› | Node Group ì¤€ë¹„ í›„ |

**ì˜ì¡´ì„± ì²´ì¸ (Terraform `depends_on`)**

```
06-iam.tf (IAM Roles)
    â†“
05-eks.tf (EKS Cluster) â† 8ë¶„
    â†“
Node Group â† 4ë¶„
    â†“
OIDC Provider â†’ ëª¨ë“  IRSA Role ì—°ë™
    â†“
Access Entry (íŒ€ì› ì ‘ê·¼)
    â†“
EBS CSI Addon (ìŠ¤í† ë¦¬ì§€)
```

**í•µì‹¬ ìˆ˜ì¹˜**
- **ì´ ë°°í¬ ì‹œê°„**: **~12ë¶„** (EKS Cluster 8ë¶„ + Node Group 4ë¶„)
- **ë¦¬ì†ŒìŠ¤ ê°œìˆ˜**: 7ê°œ (Cluster, Node Group, OIDC, Access EntryÃ—2, PolicyÃ—2, Addon)
- **Auto-scaling ë²”ìœ„**: 2 â†’ 4 ë…¸ë“œ (Cluster Autoscaler ì—°ë™)
- **íŒ€ì› ì¶”ê°€**: `terraform.tfvars`ì— ARN ì¶”ê°€ â†’ `apply` 1ë²ˆ

**ë°°í¬ í›„ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥**
```bash
# 1. kubectl ì„¤ì • (1íšŒ)
aws eks update-kubeconfig --name cali-cluster --region ap-northeast-2

# 2. ì¦‰ì‹œ í™•ì¸
kubectl get nodes
# NAME                          STATUS   AGE
# ip-172-31-47-63...internal    Ready    5d
# ip-172-31-62-32...internal    Ready    5d
```

### ë°œí‘œì ë…¸íŠ¸ (3ë¶„)

- **ë°°í¬ ìˆœì„œ ê°•ì¡°**: "IAM Roleì„ ë¨¼ì € ë§Œë“¤ì–´ì•¼(06-iam.tf) EKSê°€ í•´ë‹¹ Roleì„ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"
- **EKS Cluster ìƒì„± (8ë¶„)**:
  - "Control Plane í”„ë¡œë¹„ì €ë‹ ì‹œê°„"
  - "API, Audit, Authenticator ë¡œê¹… í™œì„±í™”ë¡œ ëª¨ë“  í´ëŸ¬ìŠ¤í„° í™œë™ ê°ì‚¬ ê°€ëŠ¥"
- **Node Group (4ë¶„)**:
  - "t3.medium Ã— 2ê°œë¡œ ì‹œì‘, ìµœëŒ€ 4ê°œê¹Œì§€ ìë™ í™•ì¥"
  - "On-Demand íƒ€ì…ìœ¼ë¡œ ì•ˆì •ì„± ìš°ì„  (Spotë³´ë‹¤ ë¹„ì‹¸ì§€ë§Œ ì‹ ë¢°ì„± ë†’ìŒ)"
- **OIDC Provider**:
  - "6ë‹¨ê³„ì—ì„œ ìƒì„±ë˜ì§€ë§Œ, ëª¨ë“  IRSAì˜ ê¸°ë°˜"
  - "ì´ Providerê°€ EKSì™€ IAM ì‚¬ì´ì˜ ì‹ ë¢° ê´€ê³„ë¥¼ ìˆ˜ë¦½í•¨"
  - "ì‹¤ì œ ê° ì„œë¹„ìŠ¤ì˜ IRSA ì„¤ì •ì€ 06-iam.tfì—ì„œ ì§„í–‰ (Consumer, Airflow, Grafana ë“± 7ê°œ Role)"
  - "ì´ê²Œ ì—†ìœ¼ë©´ 06-iam.tfì˜ ëª¨ë“  IRSA Roleì´ ì‘ë™ ë¶ˆê°€"
- **Access Entry (íŒ€ í˜‘ì—…)**:
  - "íŒ€ì› ARNë§Œ ì¶”ê°€í•˜ë©´ ìë™ìœ¼ë¡œ kubectl ì ‘ê·¼ ê¶Œí•œ ë¶€ì—¬"
  - "`update-kubeconfig` í•œ ì¤„ë¡œ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥"
- **EBS CSI Driver**:
  - "Airflow, Milvus ë“±ì´ PersistentVolumeClaimì„ ì‚¬ìš©í•˜ë ¤ë©´ í•„ìˆ˜"
  - "Terraform Addonìœ¼ë¡œ ìë™ ì„¤ì¹˜ â†’ ìˆ˜ë™ Helm ì„¤ì¹˜ ë¶ˆí•„ìš”"
- **ì¬í˜„ì„±**: "ê°™ì€ ì½”ë“œë¥¼ ë‹¤ë¥¸ ë¦¬ì „ì— applyí•˜ë©´ ë™ì¼í•œ EKS í´ëŸ¬ìŠ¤í„°ê°€ 12ë¶„ ë§Œì— ìƒì„±ë©ë‹ˆë‹¤"

---

## ğŸš¨ Slide 3: 3ê°€ì§€ í•µì‹¬ ë¬¸ì œ

### ì œëª©
**"Productionì—ì„œ ë§ˆì£¼í•œ Real-World Problems"**

### ìŠ¬ë¼ì´ë“œ ë‚´ìš©

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
             ê¸°ìˆ ì  ë‚œê´€ TOP 3
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ OpenSearch Fine-Grained Access Control (FGAC)

   ë¬¸ì œ: Terraformìœ¼ë¡œ OpenSearch ìƒì„± í›„ Firehose ì „ì†¡ ì‹¤íŒ¨
   
   âŒ Error: [403] security_exception - no permissions
   
   ì›ì¸: AWS IAM access_policies â‰  Security Plugin Role Mapping
         â†’ 2ë‹¨ê³„ ë³´ì•ˆ ê³„ì¸µì„ ëª¨ë‘ í†µê³¼í•´ì•¼ í•¨


2ï¸âƒ£ Airflow Helm Chart IRSA ì„¤ì •

   ë¬¸ì œ: Airflow Podì—ì„œ S3 ì ‘ê·¼ ë¶ˆê°€
   
   âŒ Error: NoCredentialsError: Unable to locate credentials
   
   ì›ì¸: Global ServiceAccountì—ë§Œ ì„¤ì •
         â†’ 5ê°œ ì»´í¬ë„ŒíŠ¸ë³„ ServiceAccountì— IRSA ë¯¸ì„¤ì •


3ï¸âƒ£ Windows PowerShell í™˜ê²½

   ë¬¸ì œ: Terraform local-exec ì‹¤í–‰ ì‹¤íŒ¨
   
   âŒ Error: JSON ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ ì˜¤ë¥˜
   
   ì›ì¸: ëŒ€ë¶€ë¶„ì˜ ì˜ˆì œê°€ Bash ìŠ¤í¬ë¦½íŠ¸ ê¸°ë°˜
         â†’ Windows í™˜ê²½ ê³ ë ¤ ë¶€ì¡±
```

### ë°œí‘œì ë…¸íŠ¸ (3ë¶„)

- **ë¬¸ì œ #1**: "ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ë„ ë‚´ë¶€ êµ¬ì¡°ë¥¼ ì´í•´í•´ì•¼ í•œë‹¤ëŠ” êµí›ˆ"
- **ë¬¸ì œ #2**: "Helm Chart ê³µì‹ ë¬¸ì„œë§Œ ë¯¿ìœ¼ë©´ ì•ˆ ë¨. ì‹¤ì œ ë™ì‘ í™•ì¸ í•„ìˆ˜"
- **ë¬¸ì œ #3**: "í¬ë¡œìŠ¤ í”Œë«í¼ ê³ ë ¤ì˜ ì¤‘ìš”ì„±"
- **ì²­ì¤‘ ê³µê° ìœ ë„**: "ë‹¤ë“¤ í•œ ë²ˆì¯¤ ê²ªì–´ë³´ì‹  403 ì—ëŸ¬ì£ ?"

---

## ğŸ’¡ Slide 4: í•´ê²° ì „ëµ

### ì œëª©
**"3ê°€ì§€ ì†”ë£¨ì…˜: ë„êµ¬ì˜ í•œê³„ë¥¼ ì¡°í•©ìœ¼ë¡œ ê·¹ë³µ"**

### ìŠ¬ë¼ì´ë“œ ë‚´ìš©

**í•´ê²° ì „ëµ ë§¤íŠ¸ë¦­ìŠ¤**

| ë¬¸ì œ | í•´ê²° ì ‘ê·¼ë²• | ì‚¬ìš© ë„êµ¬ | ê²°ê³¼ |
|------|-------------|----------|------|
| **OpenSearch FGAC** | Provisionerë¡œ API ì§ì ‘ í˜¸ì¶œ | Terraform + kubectl + curl | âœ… Firehose ì •ìƒ ì „ì†¡ |
| **Airflow IRSA** | ì»´í¬ë„ŒíŠ¸ë³„ ê°œë³„ ì„¤ì • | Helm `set` ë¸”ë¡ Ã— 5 | âœ… S3 ì ‘ê·¼ ì„±ê³µ |
| **Windows í™˜ê²½** | PowerShell ë„¤ì´í‹°ë¸Œ í™œìš© | `interpreter` ëª…ì‹œ | âœ… ìë™ ë¹Œë“œ ë™ì‘ |

**í•µì‹¬ ì¸ì‚¬ì´íŠ¸**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                 â”‚
â”‚  "í•˜ë‚˜ì˜ ë„êµ¬ë¡œ ëª¨ë“  ê±¸ í•´ê²°í•˜ë ¤ëŠ” ìˆœê°„,       â”‚
â”‚   ë‹¹ì‹ ì€ ë§‰íŒë‹¤."                              â”‚
â”‚                                                 â”‚
â”‚  Terraformë§Œìœ¼ë¡œ ì•ˆ ë˜ë©´ â†’ kubectl ì‚¬ìš©        â”‚
â”‚  Helmë§Œìœ¼ë¡œ ë¶€ì¡±í•˜ë©´ â†’ set ë¸”ë¡ ì˜¤ë²„ë¼ì´ë“œ     â”‚
â”‚  Bashê°€ ì•ˆ ë˜ë©´ â†’ PowerShell í™œìš©              â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ê¸°ìˆ ì  ì¡°í•©ì˜ í˜**
- Terraform (ì¸í”„ë¼) + Helm (ì•±) + kubectl (API) = ì™„ì „ ìë™í™”
- ë‹¨ì¼ ë„êµ¬ì˜ í•œê³„ ì¸ì • â†’ ìœ ì—°í•œ ì¡°í•© ì „ëµ

### ë°œí‘œì ë…¸íŠ¸ (2ë¶„)

- **í‘œ ì„¤ëª…**: "ë¬¸ì œ-í•´ê²°-ë„êµ¬-ê²°ê³¼ íë¦„ìœ¼ë¡œ ë³´ì—¬ì£¼ê¸°"
- **ê°•ì¡°ì **: "ì™„ë²½í•œ ë„êµ¬ëŠ” ì—†ë‹¤. ì¡°í•©ì´ ë‹µì´ë‹¤"
- **ì˜ˆì‹œ**: "OpenSearchëŠ” Terraform Providerë¡œ ì•ˆ ë˜ì–´ì„œ curl ì‚¬ìš©"
- **êµí›ˆ**: "ë„êµ¬ì— ì§‘ì°©í•˜ì§€ ë§ê³  ëª©í‘œ ë‹¬ì„±ì— ì§‘ì¤‘"

---

## âš¡ Slide 4.5: Auto-scaling ê²€ì¦

### ì œëª©
**"HPA + Cluster Autoscaler: 2ë‹¨ê³„ ìë™ í™•ì¥ ì‹¤ì „ ê²€ì¦"**

### ìŠ¬ë¼ì´ë“œ ë‚´ìš©

**ìë™ í™•ì¥ 2ë‹¨ê³„ ì „ëµ**

```mermaid
graph TB
    A[ë¶€í•˜ ì¦ê°€] --> B{CPU > 70%?}
    B -->|Yes| C[HPA: Pod í™•ì¥<br/>1 â†’ 5ê°œ]
    C --> D{ë…¸ë“œ ë¦¬ì†ŒìŠ¤ ë¶€ì¡±?}
    D -->|Yes| E[CA: ë…¸ë“œ ì¶”ê°€<br/>2 â†’ 4ê°œ]
    D -->|No| F[ê¸°ì¡´ ë…¸ë“œì— ë°°ì¹˜]
    E --> G[ìƒˆ ë…¸ë“œì— Pod ë°°ì¹˜]
    
    style A fill:#e0e0e0,stroke:#333,stroke-width:2px,color:#000
    style B fill:#ffd93d,stroke:#333,stroke-width:2px,color:#000
    style C fill:#95e1d3,stroke:#333,stroke-width:2px,color:#000
    style D fill:#ffd93d,stroke:#333,stroke-width:2px,color:#000
    style E fill:#4ecdc4,stroke:#333,stroke-width:2px,color:#000
    style F fill:#a8e6cf,stroke:#333,stroke-width:2px,color:#000
    style G fill:#a8e6cf,stroke:#333,stroke-width:2px,color:#000
```

**1ë‹¨ê³„: HPA (Pod ìë™ í™•ì¥) ê²€ì¦ ê²°ê³¼**

| ë‹¨ê³„ | CPU ì‚¬ìš©ë¥  | Pod ê°œìˆ˜ | ì†Œìš” ì‹œê°„ | ê²°ê³¼ |
|------|-----------|---------|---------|------|
| **ì´ˆê¸° ìƒíƒœ** | 1% | 1 | - | ëŒ€ê¸° ì¤‘ |
| **ë¶€í•˜ ë°œìƒ** | 250% | 1 â†’ 3 | **~2ë¶„** | âœ… í™•ì¥ ì„±ê³µ |
| **ë¶€í•˜ ì¤‘ë‹¨** | 1% | 3 (ìœ ì§€) | - | ì¿¨ë‹¤ìš´ ëŒ€ê¸° |
| **5ë¶„ í›„** | 1% | 3 â†’ 1 | **~6ë¶„** | âœ… ì¶•ì†Œ ì„±ê³µ |

**2ë‹¨ê³„: Cluster Autoscaler (ë…¸ë“œ ìë™ í™•ì¥) ê²€ì¦ ê²°ê³¼**

| ë‹¨ê³„ | ë…¸ë“œ ìˆ˜ | Pod ìƒíƒœ | ì†Œìš” ì‹œê°„ | ê²°ê³¼ |
|------|--------|---------|---------|------|
| **ì´ˆê¸° ìƒíƒœ** | 2ê°œ | - | - | ëŒ€ê¸° ì¤‘ |
| **ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ë°œìƒ** | 2ê°œ | ì¼ë¶€ Pending | - | CA íƒì§€ |
| **ë…¸ë“œ ì¶”ê°€** | 2 â†’ **4ê°œ** | All Running | **~2ë¶„** | âœ… í™•ì¥ ì„±ê³µ |
| **Pod ì‚­ì œ í›„** | 4ê°œ (ìœ ì§€) | - | - | ì¿¨ë‹¤ìš´ ëŒ€ê¸° |
| **10ë¶„ í›„** | 4 â†’ 2 | - | **~10ë¶„** | â³ ì¶•ì†Œ ì˜ˆì • |

**í•µì‹¬ ìˆ˜ì¹˜**
- **Metrics Server**: Terraformìœ¼ë¡œ ë°°í¬ (`09-metrics-server.tf`)
- **HPA ë°˜ì‘ ì‹œê°„**: CPU ë¶€í•˜ ê°ì§€ â†’ **2ë¶„ ë‚´ í™•ì¥**
- **HPA ì•ˆì •í™”**: 5ë¶„ ì¿¨ë‹¤ìš´ í›„ ì¶•ì†Œ (ê¸‰ê²©í•œ ì¶•ì†Œ ë°©ì§€)
- **CA ë°˜ì‘ ì‹œê°„**: Pending Pod ê°ì§€ â†’ **2ë¶„ ë‚´ ë…¸ë“œ ì¶”ê°€**
- **CA ìŠ¤ì¼€ì¼ë§**: 2 â†’ 4ê°œ (ì˜ˆìƒ 3ê°œë³´ë‹¤ 1ê°œ ë” í™•ì¥)
- **ë¦¬ì†ŒìŠ¤ íš¨ìœ¨**: ë¶€í•˜ ì—†ì„ ë•Œ ìµœì†Œ ë¦¬ì†ŒìŠ¤, í­ì¦ ì‹œ ìë™ ëŒ€ì‘

### ë°œí‘œì ë…¸íŠ¸ (3ë¶„)

- **2ë‹¨ê³„ ì „ëµ ì„¤ëª…**: "HPAê°€ ë¨¼ì € Podì„ ëŠ˜ë¦¬ê³ , ë…¸ë“œê°€ ë¶€ì¡±í•˜ë©´ CAê°€ ë…¸ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤"
- **HPA ì‹¤ì œ ë™ì‘**: 
  - "php-apache í…ŒìŠ¤íŠ¸ ì•±ì— ë¶€í•˜ë¥¼ ì£¼ë‹ˆ CPUê°€ 250%ë¡œ ìƒìŠ¹"
  - "HPAê°€ 2ë¶„ ë§Œì— Podì„ 1ê°œì—ì„œ 3ê°œë¡œ í™•ì¥"
  - "ë¶€í•˜ë¥¼ ì¤‘ë‹¨í•˜ê³  5ë¶„ ì¿¨ë‹¤ìš´ í›„ ë‹¤ì‹œ 1ê°œë¡œ ì¶•ì†Œ â†’ ê¸‰ê²©í•œ ì¶•ì†Œ ë°©ì§€"
- **CA ì‹¤ì œ ë™ì‘**:
  - "10ê°œ Pod(ê° 500m CPU)ë¥¼ ë°°í¬í•˜ë‹ˆ ë…¸ë“œ 2ê°œë¡œ ë¶€ì¡±"
  - "ì¼ë¶€ Podì´ Pending ìƒíƒœ â†’ CAê°€ ê°ì§€"
  - "2ë¶„ ë§Œì— ë…¸ë“œ 2ê°œ ì¶”ê°€ (ì´ 4ê°œ) â†’ ëª¨ë“  Pod Running"
- **í”„ë¡œë•ì…˜ ì ìš©**:
  - "Consumerì— HPA ì ìš© ì˜ˆì •: CPU 70% ì„ê³„ê°’, 1~5ê°œ Pod"
  - "Kinesis ë©”ì‹œì§€ í­ì¦ ì‹œ ìë™ìœ¼ë¡œ Consumerê°€ 5ë°° í™•ì¥"
- **ë¹„ìš© íš¨ìœ¨**: "í‰ì†Œì—” ìµœì†Œ ë¦¬ì†ŒìŠ¤, í•„ìš”í•  ë•Œë§Œ í™•ì¥ â†’ ë¹„ìš© ì ˆê°"
- **êµí›ˆ**: "ìë™ í™•ì¥ì€ ë‹¨ìˆœ ì„¤ì •ì´ ì•„ë‹ˆë¼ ì‹¤ì œ ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¡œ ê²€ì¦í•´ì•¼ í•©ë‹ˆë‹¤"

---

## ğŸ“ˆ Slide 5: ì„±ê³¼

### ì œëª©
**"ìˆ«ìë¡œ ì¦ëª…ëœ ê²°ê³¼: Production-Ready ë‹¬ì„±"**

### ìŠ¬ë¼ì´ë“œ ë‚´ìš©

**1. ë°°í¬ ì„±ëŠ¥**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  terraform apply ì‹¤í–‰ ì‹œê°„         â”‚
â”‚                                    â”‚
â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“  18ë¶„          â”‚
â”‚  OpenSearch ë„ë©”ì¸ ìƒì„±            â”‚
â”‚                                    â”‚
â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“  12ë¶„                â”‚
â”‚  EKS í´ëŸ¬ìŠ¤í„° ìƒì„±                 â”‚
â”‚                                    â”‚
â”‚  â–“â–“â–“â–“  5ë¶„                         â”‚
â”‚  ê¸°íƒ€ ë¦¬ì†ŒìŠ¤                       â”‚
â”‚                                    â”‚
â”‚  Total: 25ë¶„ âœ… (ëª©í‘œ 30ë¶„)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì¬í˜„ì„± ê²€ì¦: 3íšŒ ë°˜ë³µ í…ŒìŠ¤íŠ¸ ëª¨ë‘ ì„±ê³µ
```

**2. ë¹„ìš© íš¨ìœ¨ì„±**

| êµ¬ë¶„ | ê¸ˆì•¡ | ë‹¬ì„±ë¥  |
|------|------|--------|
| **ì˜ˆì‚°** | $50/day | - |
| **ì‹¤ì œ** | $35/day | âœ… 30% ì ˆê° |

- EKS Control Plane: $2.40
- EC2 Nodes (t3.mediumÃ—2): $2.00
- OpenSearch (t3.small): $1.50
- ê¸°íƒ€ (Kinesis, S3, Firehose): $1.10

**3. ë³´ì•ˆ ë‹¬ì„±ë„**

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Least Privilege IAM      100% âœ…
  IRSA ì ìš© (Podë³„)        100% âœ…
  AWS Credentials í•˜ë“œì½”ë”©   0% âœ…
  Security Audit ë¡œê¹…      í™œì„±í™” âœ…
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

**4. ìš´ì˜ íš¨ìœ¨ì„±**

- ì¸í”„ë¼ ë°°í¬ ì‹œê°„: **67% ì ˆê°** (ìˆ˜ë™ 75ë¶„ â†’ ìë™ 25ë¶„)
- ì¬í˜„ ê°€ëŠ¥ì„±: **100%** (ì½”ë“œ = ë¬¸ì„œ)
- íŒ€ í˜‘ì—…: **Git ê¸°ë°˜** (ì½”ë“œ ë¦¬ë·°, PR, íˆìŠ¤í† ë¦¬)

### ë°œí‘œì ë…¸íŠ¸ (2ë¶„)

- **ë°°í¬ ì‹œê°„**: "25ë¶„ì€ ëŒ€ë¶€ë¶„ AWS í”„ë¡œë¹„ì €ë‹ ì‹œê°„. ìš°ë¦¬ ì½”ë“œëŠ” ë¹ ë¦„"
- **ë¹„ìš©**: "t3.medium ì„ íƒ, Lifecycle ì •ì±…ìœ¼ë¡œ 30% ì ˆê°"
- **ë³´ì•ˆ**: "ëª¨ë“  Podê°€ IRSA ì‚¬ìš©. Credentials ë…¸ì¶œ 0ê±´"
- **ê°•ì¡°**: "ìˆ«ìê°€ ì¦ëª…. ì£¼ê´€ì  í‰ê°€ ì•„ë‹˜"

---

## ğŸ“ Slide 6: ë°°ìš´ ê²ƒê³¼ ì•ìœ¼ë¡œ

### ì œëª©
**"IaCê°€ ê°€ë¥´ì³ì¤€ ê²ƒ & Next Steps"**

### ìŠ¬ë¼ì´ë“œ ë‚´ìš©

**í•µì‹¬ êµí›ˆ TOP 3**

```
1ï¸âƒ£ Everything as Code
   
   ì½”ë“œ = ë¬¸ì„œ = ì‹¤í–‰
   Git History = ì¸í”„ë¼ ë³€ê²½ ì´ë ¥
   ì½”ë“œ ë¦¬ë·° = ì¸í”„ë¼ ë³€ê²½ ê²€í† 


2ï¸âƒ£ ë„êµ¬ì˜ í•œê³„ë¥¼ ì¸ì •í•˜ê³  ì¡°í•©í•˜ë¼
   
   Terraform + Helm + kubectl + PowerShell
   = ì™„ì „ ìë™í™”


3ï¸âƒ£ StateëŠ” ì ˆëŒ€ì  ì§„ì‹¤ (Single Source of Truth)
   
   Terraform Stateë¥¼ ë¯¿ê³ , ë³´í˜¸í•˜ê³ , ë°±ì—…í•˜ë¼
   S3 + DynamoDB Lockìœ¼ë¡œ íŒ€ í˜‘ì—…
```

**í–¥í›„ ê°œì„  ê³„íš**

| ì‹œê¸° | í•­ëª© | ëª©í‘œ |
|------|------|------|
| **1ê°œì›”** | Prometheus + Grafana ê°•í™” | ê´€ì°° ê°€ëŠ¥ì„± í–¥ìƒ |
| **1ê°œì›”** | ArgoCD GitOps ì „í™˜ | ë°°í¬ ìë™í™” |
| **3ê°œì›”** | Multi-AZ ê³ ê°€ìš©ì„± | ì¥ì•  ë³µì›ë ¥ |
| **6ê°œì›”** | Multi-Region DR | ì¬í•´ ë³µêµ¬ |

**Final Message**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                 â”‚
â”‚  "ì¸í”„ë¼ëŠ” ì˜ˆìˆ ì´ ì•„ë‹ˆë¼ ì—”ì§€ë‹ˆì–´ë§ì´ë‹¤"        â”‚
â”‚                                                 â”‚
â”‚  â€¢ ê°ê°ì´ ì•„ë‹Œ ì½”ë“œë¡œ ì •ì˜                      â”‚
â”‚  â€¢ ì¶”ì¸¡ì´ ì•„ë‹Œ ë©”íŠ¸ë¦­ìœ¼ë¡œ ì¦ëª…                  â”‚
â”‚  â€¢ ê¸°ì–µì´ ì•„ë‹Œ Gitìœ¼ë¡œ ê¸°ë¡                     â”‚
â”‚                                                 â”‚
â”‚  CALI ì¸í”„ë¼ëŠ” ì´ì œ ëˆ„êµ¬ë‚˜ ì¬í˜„ ê°€ëŠ¥í•œ ì§€ì‹     â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°œí‘œì ë…¸íŠ¸ (3ë¶„)

- **êµí›ˆ #1**: "IaCëŠ” ì„ íƒì´ ì•„ë‹Œ í•„ìˆ˜. ê·œëª¨ í™•ì¥ ì‹œ ìˆ˜ë™ ê´€ë¦¬ ë¶ˆê°€ëŠ¥"
- **êµí›ˆ #2**: "ì™„ë²½í•œ ë„êµ¬ ì°¾ì§€ ë§ê³ , ì¡°í•© ëŠ¥ë ¥ í‚¤ìš°ê¸°"
- **êµí›ˆ #3**: "State íŒŒì¼ ë‚ ì•„ê°€ë©´ ì¬ì•™. S3 ë°±ì—”ë“œ í•„ìˆ˜"
- **Next Steps**: "í˜„ì¬ëŠ” Dev í™˜ê²½. Productionì€ Multi-AZ í•„ìˆ˜"
- **Closing**: "ì§ˆë¬¸ ìˆìœ¼ì‹œë©´ ì–¸ì œë“ ì§€!"

---

## ğŸ“ ë¶€ë¡ ìŠ¬ë¼ì´ë“œ (ë°±ì—…ìš©)

### Slide 7: ìƒì„¸ ë¹„ìš© ë¶„ì„ (ì„ íƒ)

| ë¦¬ì†ŒìŠ¤ | ì‚¬ì–‘ | ì‹œê°„ë‹¹ | ì¼ì¼ ë¹„ìš© |
|--------|------|--------|----------|
| EKS Control Plane | - | $0.10 | $2.40 |
| EC2 Nodes | t3.medium Ã— 2 | $0.0416 Ã— 2 | $2.00 |
| OpenSearch | t3.small.search + 20GB | - | $1.50 |
| Kinesis Stream | ìƒ¤ë“œ 1ê°œ | $0.015 | $0.36 |
| S3 Storage | ~10GB | - | $0.23 |
| Firehose | ì „ì†¡ëŸ‰ ê¸°ë°˜ | - | $0.10 |
| **Total** | | | **$35/day** |

---

### Slide 8: IAM ê¶Œí•œ êµ¬ì¡° (Q&A ëŒ€ë¹„)

```mermaid
graph TB
    A[OIDC Provider] --> B[IAM Role: app_role]
    A --> C[IAM Role: airflow_role]
    A --> D[IAM Role: cluster_autoscaler]
    
    B --> E[ServiceAccount: consumer-sa]
    C --> F[ServiceAccount: airflow-*]
    D --> G[ServiceAccount: cluster-autoscaler]
    
    E --> H[Consumer Pod]
    F --> I[Airflow Pods]
    G --> J[Autoscaler Pod]
    
    style A fill:#ff6b6b
    style B fill:#4ecdc4
    style C fill:#4ecdc4
    style D fill:#4ecdc4
```

---

### Slide 9: Terraform íŒŒì¼ êµ¬ì¡° (ê¸°ìˆ  ì§ˆë¬¸ ëŒ€ë¹„)

```
infra/terraform/
â”œâ”€â”€ providers.tf           # AWS/Helm/K8s Provider
â”œâ”€â”€ backend.tf            # S3 State + DynamoDB Lock
â”œâ”€â”€ 01-kinesis.tf         # Stream + Firehose Ã— 2
â”œâ”€â”€ 02-s3.tf              # Logs Bucket + Lifecycle
â”œâ”€â”€ 03-opensearch.tf      # Search Engine + FGAC
â”œâ”€â”€ 04-grafana.tf         # (ì£¼ì„ ì²˜ë¦¬, Helmìœ¼ë¡œ ì´ì „)
â”œâ”€â”€ 05-eks.tf             # Cluster + Node Group
â”œâ”€â”€ 06-iam.tf             # 7ê°œ Role + Policies
â”œâ”€â”€ 07-ecr.tf             # Container Registry Ã— 3
â”œâ”€â”€ 08-autoscaler.tf      # Cluster Autoscaler
â”œâ”€â”€ 09-storage-class.tf   # gp2 StorageClass
â”œâ”€â”€ 10-helm-releases.tf   # Helm Charts Ã— 4
â”œâ”€â”€ 11-k8s-apps.tf        # Consumer + Generator
â””â”€â”€ outputs.tf            # ARN, Endpoint ì¶œë ¥
```

---

## ğŸ¤ ë°œí‘œ íŒ

### ì‹œê°„ ë°°ë¶„
- Slide 1-2: 5ë¶„ (ë°°ê²½ + ì•„í‚¤í…ì²˜)
- Slide 3-4: 5ë¶„ (ë¬¸ì œ + í•´ê²°)
- Slide 5-6: 5ë¶„ (ì„±ê³¼ + êµí›ˆ)
- Q&A: 5ë¶„

### ê°•ì¡° í¬ì¸íŠ¸
1. **ìˆ«ìë¡œ ë§í•˜ê¸°**: 25ë¶„, $35/day, 100%
2. **ì‹œê°ì  ìš”ì†Œ**: ë‹¤ì´ì–´ê·¸ë¨ í¬ì¸íŒ…
3. **ì²­ì¤‘ ì°¸ì—¬**: "ì—¬ëŸ¬ë¶„ì´ë¼ë©´?" ì§ˆë¬¸ ë˜ì§€ê¸°
4. **ì‹¤íŒ¨ ê³µìœ **: ì‹¤ìˆ˜ì™€ ê·¹ë³µ ê³¼ì • ì†”ì§í•˜ê²Œ

### ì˜ˆìƒ ì§ˆë¬¸
1. **Q: Terraform StateëŠ” ì–´ë””ì—?**
   - A: S3 ë°±ì—”ë“œ + DynamoDB Lock

2. **Q: EKS ë²„ì „ ì—…ê·¸ë ˆì´ë“œëŠ”?**
   - A: `version = "1.30"` ë³€ê²½ â†’ apply

3. **Q: ì™œ Kinesis? KafkaëŠ”?**
   - A: 5ì¼ ì¼ì •, Firehose í†µí•©, NoOps

4. **Q: Productionì—ë„ ë‹¨ì¼ OpenSearch ë…¸ë“œ?**
   - A: ì•„ë‹ˆìš”, ProdëŠ” 3ë…¸ë“œ + Multi-AZ

---

**ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ¯**
